---
import type { ImageMetadata } from 'astro'
import Figure from './Figure.astro'

interface Props {
  src: string
  alt?: string
  loading?: 'eager' | 'lazy'
  animate?: boolean
}

const { src, alt = '', loading, animate } = Astro.props

const images = import.meta.glob<{ default: ImageMetadata }>(
  '/src/assets/**/*.{webp,png,jpg,svg}'
)

const { default: image } = await images[src]()
---

{
  animate ? (
    <Figure src={image.src} width={image.width} height={image.height} />
  ) : (
    <img
      src={image.src}
      alt={alt}
      width={image.width}
      height={image.height}
      loading={loading}
    />
  )
}
